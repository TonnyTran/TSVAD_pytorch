[System initialization completed]
Model /home/users/ntu/tlkushag/scratch/TSVAD_pytorch/ts-vad/pretrained_models/ts-vad.model loaded from pretrain!
[Trainer initialization completed]

[Loader initialization completed]
### Parameters ###
max_epoch 10
warm_up_epoch 5
batch_size 10
rs_len 4.0
n_cpu 4
test_step 1
lr 0.0001
lr_decay 0.9
test_shift 0.5
min_silence 0.32
min_speech 0.0
threshold 0.5
init_model /home/users/ntu/tlkushag/scratch/TSVAD_pytorch/ts-vad/pretrained_models/ts-vad.model
train_list /home/users/ntu/tlkushag/scratch/data08/dihard/third_dihard_challenge_dev/data/ts_dev.json
train_path /home/users/ntu/tlkushag/scratch/data08/dihard/third_dihard_challenge_dev/data
eval_list /home/users/ntu/tlkushag/scratch/data08/dihard/third_dihard_challenge_eval/data/ts_eval.json
eval_path /home/users/ntu/tlkushag/scratch/data08/dihard/third_dihard_challenge_eval/data
save_path exps/res23
musan_path /home/users/ntu/tlkushag/scratch/data08/Others/musan_split
rir_path /home/users/ntu/tlkushag/scratch/data08/Others/RIRS_NOISES/simulated_rirs
speech_encoder_pretrain /home/users/ntu/tlkushag/scratch/TSVAD_pytorch/ts-vad/pretrained_models/WavLM-Base+.pt
train False
eval True
score_save_path exps/res23/score.txt
model_save_path exps/res23/model
rttm_save_path exps/res23/res_rttm
modelfiles []
score_file <_io.TextIOWrapper name='exps/res23/score.txt' mode='a+' encoding='UTF-8'>
epoch 1
trainLoader <torch.utils.data.dataloader.DataLoader object at 0x14c77b202eb0>
evalLoader <torch.utils.data.dataloader.DataLoader object at 0x14c77b202bb0>
Traceback (most recent call last):
  File "/home/users/ntu/tlkushag/scratch/TSVAD_pytorch/ts-vad/main.py", line 60, in <module>
    s.eval_network(args)
  File "/scratch/users/ntu/tlkushag/TSVAD_pytorch/ts-vad/trainer.py", line 80, in eval_network
    for num, (rs, ts, labels, filename, speaker_id, start) in enumerate(args.evalLoader, start = 1):
  File "/home/users/ntu/tlkushag/anaconda3/envs/tsvad/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 633, in __next__
    data = self._next_data()
  File "/home/users/ntu/tlkushag/anaconda3/envs/tsvad/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1345, in _next_data
    return self._process_data(data)
  File "/home/users/ntu/tlkushag/anaconda3/envs/tsvad/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1371, in _process_data
    data.reraise()
  File "/home/users/ntu/tlkushag/anaconda3/envs/tsvad/lib/python3.8/site-packages/torch/_utils.py", line 644, in reraise
    raise exception
UnboundLocalError: Caught UnboundLocalError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/home/users/ntu/tlkushag/anaconda3/envs/tsvad/lib/python3.8/site-packages/torch/utils/data/_utils/worker.py", line 308, in _worker_loop
    data = fetcher.fetch(index)
  File "/home/users/ntu/tlkushag/anaconda3/envs/tsvad/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 51, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/users/ntu/tlkushag/anaconda3/envs/tsvad/lib/python3.8/site-packages/torch/utils/data/_utils/fetch.py", line 51, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/scratch/users/ntu/tlkushag/TSVAD_pytorch/ts-vad/dataLoader.py", line 206, in __getitem__
    target_speech = self.load_ts(file, speaker_ids)
  File "/scratch/users/ntu/tlkushag/TSVAD_pytorch/ts-vad/dataLoader.py", line 253, in load_ts
    feature = torch.mean(feature, dim = 0)
UnboundLocalError: local variable 'feature' referenced before assignment

======================================================================================

			Resource Usage on 2023-10-14 01:16:18.053291:

	JobId: 3088696.pbs101  
	Project: personal-tlkushag 
	Exit Status: 1
	NCPUs Requested: 1				NCPUs Used: 1
							CPU Time Used: 00:00:00
	Memory Requested: 100gb 			Memory Used: 0b
							Vmem Used: 23298044kb
	Walltime requested: 10:00:00 			Walltime Used: 00:01:33
	
	Execution Nodes Used: (x1000c2s4b0n0:mem=104857600kb:ncpus=1:ngpus=4)
	
 ======================================================================================
